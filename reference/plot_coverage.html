<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot coverage in nuclear and cytoplasmic RNA for candidate probe sequences. — plot_coverage • brainflowprobes</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot coverage in nuclear and cytoplasmic RNA for candidate probe sequences. — plot_coverage" />
<meta property="og:description" content="plot_coverage plots the coverage of nuclear and cytoplasmic RNA from
adult and prenatal human prefrontal cortex across a candidate or series of
candidate probe sequences for BrainFlow. If the sequence spans splice
junctions, the plot will include the introns. A good candidate sequence will
be highly and evenly expressed in nuclear RNA." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brainflowprobes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/brainflowprobes-vignette.html">brainflowprobes user guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/LieberInstitute/brainflowprobes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot coverage in nuclear and cytoplasmic RNA for candidate probe sequences.</h1>
    <small class="dont-index">Source: <a href='https://github.com/LieberInstitute/brainflowprobes/blob/master/R/plot_coverage.R'><code>R/plot_coverage.R</code></a></small>
    <div class="hidden name"><code>plot_coverage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>plot_coverage</code> plots the coverage of nuclear and cytoplasmic RNA from
adult and prenatal human prefrontal cortex across a candidate or series of
candidate probe sequences for BrainFlow. If the sequence spans splice
junctions, the plot will include the introns. A good candidate sequence will
be highly and evenly expressed in nuclear RNA.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_coverage</span>(
  <span class='no'>REGION</span>,
  <span class='kw'>PDF</span> <span class='kw'>=</span> <span class='st'>"regionCoverage_fractionedData.pdf"</span>,
  <span class='kw'>OUTDIR</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(),
  <span class='kw'>COVERAGE</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>CODING_ONLY</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>VERBOSE</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>REGION</th>
      <td><p>Either a single hg19 genomic sequence including the chromosome,
start, end, and optionally strand separated by colons (e.g.,
'chr20:10199446-10288068:+'), or a string of sequences. Must be character.
Chromosome must be proceeded by 'chr'.</p></td>
    </tr>
    <tr>
      <th>PDF</th>
      <td><p>The name of the PDF file. Defaults to
<code>regionCoverage_fractionedData.pdf</code>.</p></td>
    </tr>
    <tr>
      <th>OUTDIR</th>
      <td><p>The default directory where <code>PDF</code> will be saved to.</p></td>
    </tr>
    <tr>
      <th>COVERAGE</th>
      <td><p>The output of <a href='brainflowprobes_cov.html'>brainflowprobes_cov</a> for the input
<code>REGION</code>. Defaults to <code>NULL</code> but it can be pre-computed and saved
separately since this is the step that takes the longest to run. Also, this
is the only step that depends on rtracklayer's functionality for reading
BigWig files which does not run on Windows OS. So it could be run on a
non-Windows machine, saved, and then shared with Windows users.</p></td>
    </tr>
    <tr>
      <th>CODING_ONLY</th>
      <td><p>A logical vector of length 1 specifying whether to
subset the Annotated Genes to only the coding genes. That is, whether to
subset the genes by whether they have a non-NA <code>CSS</code> value. The Annotated
Genes are downloaded with <code><a href='https://rdrr.io/pkg/GenomicState/man/GenomicStateHub.html'>GenomicState::GenomicStateHub()</a></code>.</p></td>
    </tr>
    <tr>
      <th>VERBOSE</th>
      <td><p>A logical value indicating whether to print updates from the
process of loading the data from the BigWig files.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>plot_coverage</code> plots all input sequences using
<code><a href='https://rdrr.io/pkg/derfinderPlot/man/plotRegionCoverage.html'>derfinderPlot::plotRegionCoverage()</a></code>. It returns a plot for each
input candidate sequence listed in REGION. Each plot includes coverage of
the sequence(s) in nuclear (N) and cytoplasmic (C) RNA isolated from adult
(A) and fetal (F) prefrontal cortex, sequenced using two different library
preparation methods. PolyA+ libraries (P) were generated using selection
for polyadenylated transcripts, and RiboZero (R) libraries were generated
using a ribosomal RNA depletion protocol.</p>
<p>Each plot also shows the overlapping genes beneath the coverage, and the
genomic location. The title lists the nearest gene, the position of the
sequence relative to the gene's canonical transcriptional start site (TSS),
and further annotation information as described in the 'region' column from
<code><a href='https://rdrr.io/pkg/bumphunter/man/matchGenes.html'>bumphunter::matchGenes()</a></code>.</p>
<p><code>plot_coverage</code> saves the results as regionCoverage_fractionedData.pdf
in a temporary directory unless otherwise specified with <code>OUTDIR</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Here we use the pre-saved example coverage data such that this example</span>
<span class='co'>## will run fast!</span>
<span class='fu'>plot_coverage</span>(<span class='st'>"chr20:10286777-10288069:+"</span>,
    <span class='kw'>COVERAGE</span> <span class='kw'>=</span> <span class='no'>four_panels_example_cov</span>
)</div><div class='output co'>#&gt; <span class='message'>snapshotDate(): 2020-03-31</span></div><div class='output co'>#&gt; <span class='message'>loading from cache</span></div><div class='output co'>#&gt; <span class='message'>snapshotDate(): 2020-03-31</span></div><div class='output co'>#&gt; <span class='message'>downloading 1 resources</span></div><div class='output co'>#&gt; <span class='message'>retrieving 1 resource</span></div><div class='output co'>#&gt; <span class='message'>loading from cache</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:19 annotateRegions: counting</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:20 annotateRegions: annotating</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:20 Completed! Check for /tmp/RtmpnBvzK4/regionCoverage_fractionedData.pdf.</span></div><div class='input'>
<span class='co'>## Without using COVERAGE, this function reads BigWig files from the web</span>
<span class='co'>## using rtracklayer and this functionality is not supported on Windows</span>
<span class='co'>## machines.</span>
<span class='kw'>if</span> (<span class='no'>.Platform</span>$<span class='no'>OS.type</span> <span class='kw'>!=</span> <span class='st'>"windows"</span>) {
    <span class='fu'>plot_coverage</span>(<span class='st'>"chr20:10286777-10288069:+"</span>,
        <span class='kw'>PDF</span> <span class='kw'>=</span> <span class='st'>"regionCoverage_fractionedData_fromScratch.pdf"</span>
    )
}</div><div class='output co'>#&gt; <span class='message'>snapshotDate(): 2020-03-31</span></div><div class='output co'>#&gt; <span class='message'>loading from cache</span></div><div class='output co'>#&gt; <span class='message'>snapshotDate(): 2020-03-31</span></div><div class='output co'>#&gt; <span class='message'>loading from cache</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:37 annotateRegions: counting</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:38 annotateRegions: annotating</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:38 getRegionCoverage : attempting to load coverage data from 'files'.</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:38 fullCoverage: processing chromosome chr20</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:38 loadCoverage: finding chromosome lengths</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:38 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br1113C1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:39 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br1113N1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:40 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2046C_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:41 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2046N_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:42 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2074C_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:43 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2074N_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:44 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5339C1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:45 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5339N1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:45 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5340C1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:46 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5340N1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:47 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5341C1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:48 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5341N1_polyA.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:49 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br1113C1_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:50 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2046C_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:51 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2046N_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:52 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2074C_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:53 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br2074N_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:54 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5339C1_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:55 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5339N1_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:56 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5340C1_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:57 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5340N1_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:58 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5341C1_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:58 loadCoverage: loading BigWig file http://brain-flow-rna.s3.us-east-2.amazonaws.com/Sep/Br5341N1_RiboZero.bw</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:01:59 loadCoverage: applying the cutoff to the merged data</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:02:00 filterData: originally there were 63025520 rows, now there are 63025520 rows. Meaning that 0 percent was filtered.</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:02:00 getRegionCoverage: processing chr20</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:02:00 getRegionCoverage: done processing chr20</span></div><div class='output co'>#&gt; <span class='message'>2020-04-27 07:02:00 Completed! Check for /tmp/RtmpnBvzK4/regionCoverage_fractionedData_fromScratch.pdf.</span></div><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='co'>## These examples will take a few minutes to run!</span>
<span class='fu'>plot_coverage</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(
    <span class='st'>"chr20:10286777-10288069:+"</span>,
    <span class='st'>"chr18:74690788-74692427:-"</span>,
    <span class='st'>"chr19:49932861-49933829:-"</span>
))

<span class='no'>candidates</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(
    <span class='st'>"chr20:10286777-10288069:+"</span>,
    <span class='st'>"chr18:74690788-74692427:-"</span>,
    <span class='st'>"chr19:49932861-49933829:-"</span>
)

<span class='co'>## General syntax:</span>
<span class='fu'>plot_coverage</span>(<span class='no'>candidates</span>,
    <span class='kw'>PDF</span> <span class='kw'>=</span> <span class='st'>"PDF_file.pdf"</span>,
    <span class='kw'>OUTDIR</span> <span class='kw'>=</span> <span class='st'>"/path/to/directory/"</span>
)

<span class='fu'>plot_coverage</span>(<span class='st'>"chr20:10286777-10288069:+"</span>,
    <span class='kw'>PDF</span> <span class='kw'>=</span> <span class='st'>"PDF_file.pdf"</span>, <span class='kw'>OUTDIR</span> <span class='kw'>=</span> <span class='st'>"/path/to/directory/"</span>
)

<span class='co'>## Explore the effect of changing CODING_ONLY</span>
<span class='co'>## Check how gene name and distance to TSS changes in the title of the plot</span>
<span class='co'>## (everything else stays the same)</span>
<span class='no'>cov</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='brainflowprobes_cov.html'>brainflowprobes_cov</a></span>(<span class='st'>"chr10:135379301-135379311:+"</span>)
<span class='fu'>plot_coverage</span>(<span class='st'>"chr10:135379301-135379311:+"</span>, <span class='kw'>COVERAGE</span> <span class='kw'>=</span> <span class='no'>cov</span>)
<span class='fu'>plot_coverage</span>(<span class='st'>"chr10:135379301-135379311:+"</span>,
    <span class='kw'>COVERAGE</span> <span class='kw'>=</span> <span class='no'>cov</span>,
    <span class='kw'>PDF</span> <span class='kw'>=</span> <span class='st'>"coding_only_plot_coverage"</span>, <span class='kw'>CODING_ONLY</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Amanda Price.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


